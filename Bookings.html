<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Binge Leisure Resort | Book Your Luxury Stay</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@300;400;500;600;700&family=Montserrat:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #BC8A5F;
            --secondary-color: #3D5A5B;
            --accent-color: #A52A2A;
            --light-color: #F7F3EE;
            --dark-color: #1A1A1A;
            --text-color: #333333;
            --text-light: #666666;
        }
        
        body {
            font-family: 'Montserrat', sans-serif;
            color: var(--text-color);
            padding-top: 20px;
            background-color: #f9f9f9;
        }
        
        h1, h2, h3, h4, h5 {
            font-family: 'Cormorant Garamond', serif;
            font-weight: 600;
        }
        
        .booking-form {
            background-color: white;
            border-radius: 15px;
            padding: 2.5rem;
            box-shadow: 0 5px 25px rgba(0,0,0,0.08);
            margin-bottom: 40px;
        }
        
        .bookings-table {
            margin-top: 40px;
        }
        
        .table-responsive {
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .table thead {
            background-color: var(--secondary-color);
            color: white;
        }
        
        .form-label {
            font-weight: 600;
            color: var(--secondary-color);
            margin-bottom: 8px;
        }
        
        .form-control, .form-select {
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            transition: all 0.3s;
        }
        
        .form-control:focus, .form-select:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 0.25rem rgba(188, 138, 95, 0.25);
        }
        
        .btn-primary {
            background-color: var(--primary-color);
            border-color: var(--primary-color);
            padding: 14px 30px;
            font-weight: 600;
            border-radius: 8px;
            transition: all 0.3s;
        }
        
        .btn-primary:hover {
            background-color: var(--accent-color);
            border-color: var(--accent-color);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(188, 138, 95, 0.3);
        }
        
        .price-display {
            background-color: var(--light-color);
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            border-left: 4px solid var(--primary-color);
        }
        
        .total-price {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--primary-color);
        }
        
        .feature-icon {
            font-size: 24px;
            color: var(--primary-color);
            margin-right: 10px;
        }
        
        .file-upload-container {
            border: 2px dashed #ddd;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            margin-bottom: 20px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .file-upload-container:hover {
            border-color: var(--primary-color);
            background-color: rgba(188, 138, 95, 0.05);
        }
        
        .file-upload-container.active {
            border-color: var(--primary-color);
            background-color: rgba(188, 138, 95, 0.1);
        }
        
        .file-preview {
            max-width: 100px;
            max-height: 100px;
            margin-top: 10px;
            display: none;
        }
        
        .upload-status {
            font-size: 0.9rem;
            color: #666;
            margin-top: 5px;
        }
        
        .progress {
            height: 8px;
            margin-top: 10px;
            display: none;
        }
        
        .room-option {
            border: 2px solid #eee;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .room-option:hover {
            border-color: var(--primary-color);
            background-color: rgba(188, 138, 95, 0.05);
        }
        
        .room-option.selected {
            border-color: var(--primary-color);
            background-color: rgba(188, 138, 95, 0.1);
        }
        
        .room-price {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--primary-color);
        }
        
        .resort-header {
            background: linear-gradient(rgba(0,0,0,0.7), rgba(0,0,0,0.7)), url('https://images.unsplash.com/photo-1566073771259-6a8506099945?ixlib=rb-4.0.3&auto=format&fit=crop&w=2070&q=80');
            background-size: cover;
            background-position: center;
            color: white;
            padding: 40px 0;
            border-radius: 15px;
            margin-bottom: 30px;
        }
        
        .status-badge {
            padding: 5px 12px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.85rem;
        }
        
        .status-confirmed {
            background-color: #d4edda;
            color: #155724;
        }
        
        .status-pending {
            background-color: #fff3cd;
            color: #856404;
        }
        
        .status-cancelled {
            background-color: #f8d7da;
            color: #721c24;
        }
        
        .dining-option {
            border-left: 4px solid var(--secondary-color);
            padding-left: 15px;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-12">
                <!-- Resort Header -->
                <div class="resort-header text-center">
                    <h1 class="display-4 mb-3">Binge Leisure Resort</h1>
                    <p class="lead mb-0">Book Your Elevated Luxury Experience</p>
                </div>
                
                <!-- Booking Form -->
                <div class="booking-form">
                    <h2 class="mb-4">Make a Reservation</h2>
                    <form id="bookingForm">
                        <!-- Personal Information -->
                        <div class="row mb-4">
                            <div class="col-md-6 mb-3">
                                <label for="firstName" class="form-label">First Name *</label>
                                <input type="text" class="form-control" id="firstName" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="lastName" class="form-label">Last Name *</label>
                                <input type="text" class="form-control" id="lastName" required>
                            </div>
                        </div>
                        
                        <div class="row mb-4">
                            <div class="col-md-6 mb-3">
                                <label for="email" class="form-label">Email Address *</label>
                                <input type="email" class="form-control" id="email" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="phone" class="form-label">Phone Number *</label>
                                <input type="tel" class="form-control" id="phone" required>
                            </div>
                        </div>
                        
                        <div class="row mb-4">
                            <div class="col-md-6 mb-3">
                                <label for="idNumber" class="form-label">ID/Passport Number</label>
                                <input type="text" class="form-control" id="idNumber">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="nationality" class="form-label">Nationality</label>
                                <input type="text" class="form-control" id="nationality" value="South African">
                            </div>
                        </div>
                        
                        <!-- Accommodation Selection -->
                        <div class="mb-4">
                            <h4 class="mb-3"><i class="fas fa-bed feature-icon"></i> Select Accommodation</h4>
                            <div class="row">
                                <div class="col-md-4">
                                    <div class="room-option" data-room-type="treetop-villa" data-price="1200">
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="roomType" id="treetopVilla" value="treetop-villa">
                                            <label class="form-check-label" for="treetopVilla">
                                                <strong>Treetop Villa</strong>
                                            </label>
                                        </div>
                                        <p class="mb-1">Private balcony with dam views</p>
                                        <p class="mb-1">King bed, ensuite bathroom</p>
                                        <p class="mb-2">Sleeps: 2 adults</p>
                                        <div class="room-price">R1,200 / night</div>
                                    </div>
                                </div>
                                
                                <div class="col-md-4">
                                    <div class="room-option" data-room-type="waterfront-suite" data-price="2500">
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="roomType" id="waterfrontSuite" value="waterfront-suite">
                                            <label class="form-check-label" for="waterfrontSuite">
                                                <strong>Waterfront Suite</strong>
                                            </label>
                                        </div>
                                        <p class="mb-1">Direct dam access, private dock</p>
                                        <p class="mb-1">Infinity pool, butler service</p>
                                        <p class="mb-2">Sleeps: 2 adults, 2 children</p>
                                        <div class="room-price">R2,500 / night</div>
                                    </div>
                                </div>
                                
                                <div class="col-md-4">
                                    <div class="room-option" data-room-type="executive-residence" data-price="5000">
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="roomType" id="executiveResidence" value="executive-residence">
                                            <label class="form-check-label" for="executiveResidence">
                                                <strong>Executive Residence</strong>
                                            </label>
                                        </div>
                                        <p class="mb-1">Private chef, helicopter pad</p>
                                        <p class="mb-1">3 bedrooms, dedicated concierge</p>
                                        <p class="mb-2">Sleeps: 6 guests</p>
                                        <div class="room-price">R5,000 / night</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Stay Duration -->
                        <div class="row mb-4">
                            <div class="col-md-6 mb-3">
                                <label for="stayDuration" class="form-label">Stay Duration *</label>
                                <select class="form-select" id="stayDuration" required>
                                    <option value="">Select duration</option>
                                    <option value="1">1 Day/Night</option>
                                    <option value="2">2 Days/Nights</option>
                                    <option value="3">3 Days/Nights</option>
                                    <option value="4">4 Days/Nights</option>
                                    <option value="5">5 Days/Nights</option>
                                    <option value="7">7 Days/Nights (Week)</option>
                                    <option value="14">14 Days/Nights (Fortnight)</option>
                                </select>
                            </div>
                            
                            <div class="col-md-6 mb-3">
                                <label for="guestCount" class="form-label">Number of Guests *</label>
                                <select class="form-select" id="guestCount" required>
                                    <option value="">Select guests</option>
                                    <option value="1">1 Guest</option>
                                    <option value="2">2 Guests</option>
                                    <option value="3">3 Guests</option>
                                    <option value="4">4 Guests</option>
                                    <option value="5">5 Guests</option>
                                    <option value="6">6 Guests</option>
                                    <option value="7">7+ Guests (Contact us)</option>
                                </select>
                            </div>
                        </div>
                        
                        <!-- Dates -->
                        <div class="row mb-4">
                            <div class="col-md-6 mb-3">
                                <label for="checkinDate" class="form-label">Check-in Date *</label>
                                <input type="date" class="form-control" id="checkinDate" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="checkoutDate" class="form-label">Check-out Date *</label>
                                <input type="date" class="form-control" id="checkoutDate" required>
                            </div>
                        </div>
                        
                        <!-- Raised Dining Experience -->
                        <div class="mb-4">
                            <h4 class="mb-3"><i class="fas fa-arrow-up feature-icon"></i> 40-Foot Raised Dining Experience</h4>
                            <div class="dining-option">
                                <div class="form-check mb-2">
                                    <input class="form-check-input" type="checkbox" id="includeDining" value="true">
                                    <label class="form-check-label" for="includeDining">
                                        <strong>Include Raised Dining Experience</strong>
                                    </label>
                                </div>
                                <p class="mb-2">Enjoy gourmet meals 40 feet above ground with panoramic views. Additional R850 per person.</p>
                                
                                <div class="row mt-3" id="diningDetails" style="display: none;">
                                    <div class="col-md-6 mb-3">
                                        <label for="diningDate" class="form-label">Preferred Dining Date</label>
                                        <input type="date" class="form-control" id="diningDate">
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label for="diningGuests" class="form-label">Number of Dining Guests</label>
                                        <select class="form-select" id="diningGuests">
                                            <option value="1">1 Guest</option>
                                            <option value="2" selected>2 Guests</option>
                                            <option value="3">3 Guests</option>
                                            <option value="4">4 Guests</option>
                                            <option value="5">5 Guests</option>
                                            <option value="6">6 Guests</option>
                                        </select>
                                    </div>
                                    <div class="col-md-12 mb-3">
                                        <label for="diningTime" class="form-label">Preferred Dining Time</label>
                                        <select class="form-select" id="diningTime">
                                            <option value="18:00">18:00 - Sunset Dinner</option>
                                            <option value="19:00">19:00 - Evening Dining</option>
                                            <option value="20:00">20:00 - Late Evening</option>
                                            <option value="12:00">12:00 - Lunch</option>
                                            <option value="08:00">08:00 - Breakfast</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Additional Services -->
                        <div class="mb-4">
                            <h4 class="mb-3"><i class="fas fa-concierge-bell feature-icon"></i> Additional Services</h4>
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="airportTransfer" value="true">
                                        <label class="form-check-label" for="airportTransfer">
                                            Airport Transfer (R450 each way)
                                        </label>
                                    </div>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="spaTreatment" value="true">
                                        <label class="form-check-label" for="spaTreatment">
                                            Spa Treatment Package (R1,200)
                                        </label>
                                    </div>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="damActivities" value="true">
                                        <label class="form-check-label" for="damActivities">
                                            Dam Activities Package (R800)
                                        </label>
                                    </div>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="performanceTickets" value="true">
                                        <label class="form-check-label" for="performanceTickets">
                                            Performance Tickets (R300 per person)
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- ID Document Upload (Optional) -->
                        <div class="mb-4">
                            <label class="form-label">ID/Passport Document (Optional)</label>
                            <p class="text-muted small mb-2">Upload a copy of your ID or passport for faster check-in.</p>
                            <div class="file-upload-container" id="idUploadContainer">
                                <input type="file" id="idDocument" accept=".pdf,.jpg,.jpeg,.png" style="display: none;">
                                <i class="fas fa-id-card fa-3x mb-2"></i>
                                <p>Click to upload ID/Passport document<br>
                                <small>PDF, JPG, or PNG (max 5MB)</small></p>
                                <img id="idPreview" class="file-preview">
                                <div class="upload-status" id="idUploadStatus">No file selected</div>
                                <div class="progress" id="idUploadProgress">
                                    <div class="progress-bar" role="progressbar" style="width: 0%"></div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Special Requests -->
                        <div class="mb-4">
                            <label for="specialRequests" class="form-label">Special Requests</label>
                            <textarea class="form-control" id="specialRequests" rows="3" placeholder="Any dietary requirements, celebration notes, or special requests..."></textarea>
                        </div>
                        
                        <!-- Price Summary -->
                        <div class="price-display">
                            <h4 class="mb-3">Booking Summary</h4>
                            <div class="row">
                                <div class="col-md-6">
                                    <p>Accommodation: <span id="accommodationCost">R0</span></p>
                                    <p>Raised Dining: <span id="diningCost">R0</span></p>
                                    <p>Additional Services: <span id="servicesCost">R0</span></p>
                                </div>
                                <div class="col-md-6 text-end">
                                    <h3 class="total-price" id="totalPrice">R0</h3>
                                    <p class="text-muted small">Total for your stay</p>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Submit Button -->
                        <div class="d-grid mt-4">
                            <button type="submit" class="btn btn-primary btn-lg" id="submitBtn">
                                <span id="submitText">Complete Booking</span>
                                <span id="submitSpinner" class="spinner-border spinner-border-sm" role="status" aria-hidden="true" style="display: none;"></span>
                            </button>
                            <p class="text-muted small mt-2 text-center">By booking, you agree to our <a href="#">Terms & Conditions</a> and <a href="#">Cancellation Policy</a>.</p>
                        </div>
                    </form>
                </div>
                
                <!-- Bookings Table -->
                <div class="bookings-table">
                    <h3 class="mb-4">Recent Bookings</h3>
                    <div class="table-responsive">
                        <table class="table table-striped table-hover">
                            <thead>
                                <tr>
                                    <th>Guest Name</th>
                                    <th>Accommodation</th>
                                    <th>Check-in</th>
                                    <th>Duration</th>
                                    <th>Guests</th>
                                    <th>Raised Dining</th>
                                    <th>Total Amount</th>
                                    <th>Date Booked</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody id="bookingsTableBody">
                                <!-- Bookings will be loaded here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-storage-compat.js"></script>
    
    <script>
        // Your Firebase configuration (same as provided)
        const firebaseConfig = {
            apiKey: "AIzaSyAxKSE5ehafOnwm5W9i3kqbGup8xQ9nHKI",
            authDomain: "abceducation-d0254.firebaseapp.com",
            databaseURL: "https://abceducation-d0254-default-rtdb.firebaseio.com",
            projectId: "abceducation-d0254",
            storageBucket: "abceducation-d0254.firebasestorage.app",
            messagingSenderId: "911901882839",
            appId: "1:911901882839:web:4ce293724f34ddc8c17392"
        };

        // Initialize Firebase
        const app = firebase.initializeApp(firebaseConfig);
        const database = firebase.database();
        const storage = firebase.storage();

        // Reference to the resort bookings in the database
        const bookingsRef = database.ref('resortBookings');

        // File upload variables
        let idDocumentFile = null;
        let idDocumentUrl = '';

        // Set minimum dates for check-in and check-out
        const today = new Date();
        const tomorrow = new Date(today);
        tomorrow.setDate(tomorrow.getDate() + 1);
        
        const formatDate = (date) => {
            return date.toISOString().split('T')[0];
        };
        
        document.getElementById('checkinDate').min = formatDate(today);
        document.getElementById('checkinDate').value = formatDate(today);
        document.getElementById('checkoutDate').min = formatDate(tomorrow);
        document.getElementById('checkoutDate').value = formatDate(tomorrow);
        
        // Update checkout date based on stay duration
        document.getElementById('stayDuration').addEventListener('change', function() {
            const duration = parseInt(this.value);
            const checkinDate = new Date(document.getElementById('checkinDate').value);
            const checkoutDate = new Date(checkinDate);
            checkoutDate.setDate(checkoutDate.getDate() + duration);
            
            document.getElementById('checkoutDate').value = formatDate(checkoutDate);
            calculateTotal();
        });
        
        // Update check-out min date when check-in changes
        document.getElementById('checkinDate').addEventListener('change', function() {
            const checkinDate = new Date(this.value);
            const duration = parseInt(document.getElementById('stayDuration').value) || 1;
            const checkoutDate = new Date(checkinDate);
            checkoutDate.setDate(checkoutDate.getDate() + duration);
            
            document.getElementById('checkoutDate').min = formatDate(checkinDate);
            document.getElementById('checkoutDate').value = formatDate(checkoutDate);
            calculateTotal();
        });
        
        // Room selection styling
        document.querySelectorAll('.room-option').forEach(option => {
            option.addEventListener('click', function() {
                // Remove selected class from all options
                document.querySelectorAll('.room-option').forEach(opt => {
                    opt.classList.remove('selected');
                });
                
                // Add selected class to clicked option
                this.classList.add('selected');
                
                // Check the radio button inside
                const radioBtn = this.querySelector('.form-check-input');
                radioBtn.checked = true;
                
                calculateTotal();
            });
        });
        
        // Toggle dining details
        document.getElementById('includeDining').addEventListener('change', function() {
            const diningDetails = document.getElementById('diningDetails');
            if (this.checked) {
                diningDetails.style.display = 'block';
            } else {
                diningDetails.style.display = 'none';
            }
            calculateTotal();
        });
        
        // Update dining date to match check-in if not set
        document.getElementById('checkinDate').addEventListener('change', function() {
            const diningDate = document.getElementById('diningDate');
            if (!diningDate.value) {
                diningDate.value = this.value;
            }
        });
        
        // File upload setup
        document.getElementById('idUploadContainer').addEventListener('click', function() {
            document.getElementById('idDocument').click();
        });

        // Handle ID document selection
        document.getElementById('idDocument').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                idDocumentFile = file;
                document.getElementById('idUploadStatus').textContent = `Selected: ${file.name}`;
                document.getElementById('idUploadContainer').classList.add('active');
                
                // Show preview if image
                if (file.type.startsWith('image/')) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        const preview = document.getElementById('idPreview');
                        preview.src = e.target.result;
                        preview.style.display = 'block';
                    };
                    reader.readAsDataURL(file);
                }
            }
        });

        // Upload file to Firebase Storage
        function uploadFile(file, path) {
            return new Promise((resolve, reject) => {
                const storageRef = storage.ref(path);
                const uploadTask = storageRef.put(file);
                
                uploadTask.on('state_changed',
                    (snapshot) => {
                        // Progress monitoring
                        const progress = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;
                        document.getElementById('idUploadProgress').style.display = 'block';
                        document.getElementById('idUploadProgress').querySelector('.progress-bar').style.width = progress + '%';
                    },
                    (error) => {
                        reject(error);
                    },
                    () => {
                        uploadTask.snapshot.ref.getDownloadURL().then((downloadURL) => {
                            resolve(downloadURL);
                        });
                    }
                );
            });
        }
        
        // Calculate total price
        function calculateTotal() {
            // Get selected room price
            const selectedRoom = document.querySelector('.room-option.selected');
            const roomPricePerNight = selectedRoom ? parseInt(selectedRoom.dataset.price) : 0;
            
            // Get stay duration
            const stayDuration = parseInt(document.getElementById('stayDuration').value) || 0;
            
            // Calculate accommodation cost
            const accommodationCost = roomPricePerNight * stayDuration;
            
            // Calculate dining cost
            let diningCost = 0;
            if (document.getElementById('includeDining').checked) {
                const diningGuests = parseInt(document.getElementById('diningGuests').value) || 2;
                diningCost = 850 * diningGuests;
            }
            
            // Calculate additional services cost
            let servicesCost = 0;
            if (document.getElementById('airportTransfer').checked) servicesCost += 900; // Both ways
            if (document.getElementById('spaTreatment').checked) servicesCost += 1200;
            if (document.getElementById('damActivities').checked) servicesCost += 800;
            if (document.getElementById('performanceTickets').checked) {
                const guestCount = parseInt(document.getElementById('guestCount').value) || 2;
                servicesCost += 300 * guestCount;
            }
            
            // Calculate total
            const totalCost = accommodationCost + diningCost + servicesCost;
            
            // Update display
            document.getElementById('accommodationCost').textContent = `R${accommodationCost.toLocaleString()}`;
            document.getElementById('diningCost').textContent = `R${diningCost.toLocaleString()}`;
            document.getElementById('servicesCost').textContent = `R${servicesCost.toLocaleString()}`;
            document.getElementById('totalPrice').textContent = `R${totalCost.toLocaleString()}`;
            
            return totalCost;
        }
        
        // Add event listeners for price calculation
        document.querySelectorAll('input, select').forEach(element => {
            element.addEventListener('change', calculateTotal);
        });
        
        // Initial calculation
        calculateTotal();

        // Form submission handler
        document.getElementById('bookingForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            // Disable submit button and show spinner
            const submitBtn = document.getElementById('submitBtn');
            const submitText = document.getElementById('submitText');
            const submitSpinner = document.getElementById('submitSpinner');
            
            submitBtn.disabled = true;
            submitText.textContent = 'Processing Booking...';
            submitSpinner.style.display = 'inline-block';
            
            try {
                // Get form values
                const firstName = document.getElementById('firstName').value;
                const lastName = document.getElementById('lastName').value;
                const email = document.getElementById('email').value;
                const phone = document.getElementById('phone').value;
                const idNumber = document.getElementById('idNumber').value;
                const nationality = document.getElementById('nationality').value;
                const roomType = document.querySelector('input[name="roomType"]:checked')?.value || '';
                const stayDuration = document.getElementById('stayDuration').value;
                const guestCount = document.getElementById('guestCount').value;
                const checkinDate = document.getElementById('checkinDate').value;
                const checkoutDate = document.getElementById('checkoutDate').value;
                const includeDining = document.getElementById('includeDining').checked;
                const diningDate = document.getElementById('diningDate').value;
                const diningGuests = document.getElementById('diningGuests').value;
                const diningTime = document.getElementById('diningTime').value;
                const airportTransfer = document.getElementById('airportTransfer').checked;
                const spaTreatment = document.getElementById('spaTreatment').checked;
                const damActivities = document.getElementById('damActivities').checked;
                const performanceTickets = document.getElementById('performanceTickets').checked;
                const specialRequests = document.getElementById('specialRequests').value;
                
                const timestamp = new Date().toISOString();
                const status = "Confirmed";
                const bookingId = 'BLR' + Date.now();
                
                // Get room name based on type
                let roomName = '';
                switch(roomType) {
                    case 'treetop-villa': roomName = 'Treetop Villa'; break;
                    case 'waterfront-suite': roomName = 'Waterfront Suite'; break;
                    case 'executive-residence': roomName = 'Executive Residence'; break;
                    default: roomName = 'Not Selected';
                }
                
                // Upload ID document if provided
                if (idDocumentFile) {
                    const idDocPath = `booking_documents/${bookingId}_${idDocumentFile.name}`;
                    idDocumentUrl = await uploadFile(idDocumentFile, idDocPath);
                }
                
                // Calculate total price
                const totalAmount = calculateTotal();
                
                // Create booking object
                const booking = {
                    bookingId,
                    firstName,
                    lastName,
                    email,
                    phone,
                    idNumber,
                    nationality,
                    roomType,
                    roomName,
                    stayDuration,
                    guestCount,
                    checkinDate,
                    checkoutDate,
                    includeDining,
                    diningDate: includeDining ? diningDate : '',
                    diningGuests: includeDining ? diningGuests : 0,
                    diningTime: includeDining ? diningTime : '',
                    airportTransfer,
                    spaTreatment,
                    damActivities,
                    performanceTickets,
                    specialRequests,
                    idDocumentUrl: idDocumentUrl || '',
                    timestamp,
                    status,
                    totalAmount
                };
                
                // Push to Firebase
                await bookingsRef.push(booking);
                
                alert(`Booking confirmed! Your booking ID is: ${bookingId}\nA confirmation email has been sent to ${email}`);
                document.getElementById('bookingForm').reset();
                
                // Reset file upload
                document.getElementById('idPreview').style.display = 'none';
                document.getElementById('idUploadContainer').classList.remove('active');
                document.getElementById('idUploadStatus').textContent = 'No file selected';
                document.getElementById('idUploadProgress').style.display = 'none';
                
                // Reset file variables
                idDocumentFile = null;
                idDocumentUrl = '';
                
                // Reset dates
                document.getElementById('checkinDate').value = formatDate(today);
                document.getElementById('checkoutDate').value = formatDate(tomorrow);
                
                // Reset room selection
                document.querySelectorAll('.room-option').forEach(opt => {
                    opt.classList.remove('selected');
                });
                
                // Reset dining section
                document.getElementById('includeDining').checked = false;
                document.getElementById('diningDetails').style.display = 'none';
                
                // Recalculate total
                calculateTotal();
                
            } catch (error) {
                console.error('Error submitting booking: ', error);
                alert('Error submitting booking. Please try again.');
            } finally {
                // Re-enable submit button
                submitBtn.disabled = false;
                submitText.textContent = 'Complete Booking';
                submitSpinner.style.display = 'none';
            }
        });

        // Load and display bookings from Firebase
        bookingsRef.on('value', (snapshot) => {
            const bookings = snapshot.val();
            const tableBody = document.getElementById('bookingsTableBody');
            tableBody.innerHTML = '';
            
            if (bookings) {
                Object.entries(bookings).forEach(([key, booking]) => {
                    const row = document.createElement('tr');
                    
                    // Format the date for display
                    const bookingDate = new Date(booking.timestamp);
                    const formattedDate = bookingDate.toLocaleDateString();
                    
                    // Format check-in date
                    const checkinDate = new Date(booking.checkinDate);
                    const formattedCheckin = checkinDate.toLocaleDateString();
                    
                    // Format dining info
                    let diningInfo = 'No';
                    if (booking.includeDining) {
                        diningInfo = `Yes (${booking.diningGuests} guests)`;
                    }
                    
                    // Status badge
                    let statusClass = 'status-confirmed';
                    if (booking.status === 'Pending') statusClass = 'status-pending';
                    if (booking.status === 'Cancelled') statusClass = 'status-cancelled';
                    
                    row.innerHTML = `
                        <td>${booking.firstName} ${booking.lastName}</td>
                        <td>${booking.roomName}</td>
                        <td>${formattedCheckin}</td>
                        <td>${booking.stayDuration} nights</td>
                        <td>${booking.guestCount}</td>
                        <td>${diningInfo}</td>
                        <td>R${parseInt(booking.totalAmount).toLocaleString()}</td>
                        <td>${formattedDate}</td>
                        <td><span class="status-badge ${statusClass}">${booking.status}</span></td>
                    `;
                    
                    tableBody.appendChild(row);
                });
            } else {
                tableBody.innerHTML = '<tr><td colspan="9" class="text-center">No bookings found</td></tr>';
            }
        });
    </script>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
